---
layout: default
---

{% if page.header.overlay_color or page.header.overlay_image or page.header.image %}
  {% include page__hero.html %}
{% elsif page.header.video.id and page.header.video.provider %}
  {% include page__hero_video.html %}
{% endif %}

{% assign breadcrumbs_enabled = site.breadcrumbs %}
{% if page.breadcrumbs != null %}
  {% assign breadcrumbs_enabled = page.breadcrumbs %}
{% endif %}
{% if page.url != "/" and breadcrumbs_enabled %}
  {% unless paginator %}
    {% include breadcrumbs.html %}
  {% endunless %}
{% endif %}

<div id="main" role="main">
  {% include sidebar.html %}

  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    {% if page.title %}<meta itemprop="headline" content="{{ page.title | markdownify | strip_html | strip_newlines | escape_once }}">{% endif %}
    {% if page.excerpt %}<meta itemprop="description" content="{{ page.excerpt | markdownify | strip_html | strip_newlines | escape_once }}">{% endif %}
    {% if page.date %}<meta itemprop="datePublished" content="{{ page.date | date_to_xmlschema }}">{% endif %}
    {% if page.last_modified_at %}<meta itemprop="dateModified" content="{{ page.last_modified_at | date_to_xmlschema }}">{% endif %}

    <div class="page__inner-wrap">
      {% unless page.header.overlay_color or page.header.overlay_image %}
      
        <header>
          {% if page.title %}
            <h1 id="page-title" class="page__title p-name" itemprop="headline">
              <a href="{{ page.url | absolute_url }}" class="u-url" itemprop="url">{{ page.title | markdownify | remove: "<p>" | remove: "</p>" }}</a>
            </h1>{% endif %}

                {% comment %} I added the page.subtitle and its CSS class in _page.scss {% endcomment %}
                {% if page.subtitle %}
                <h1 id="page-subtitle" class="page__subtitle" itemprop="headline">
                  <a href="{{ page.url | absolute_url }}" class="u-url" itemprop="url">{{ page.subtitle | markdownify | remove: "<p>" | remove: "</p>" }}</a>
                </h1>
                {% endif %}

                {% comment %} If you want the subtitle without link
                {% if page.subtitle %}
                <span class="page__subtitle">{{ page.subtitle }}</span>
                {% endif %}
                {% endcomment %}

          {% include page__meta.html %}

          {% comment %}
           The next line is the tags and categories taxonomy, was in the footer section below, I brought it to the header section of the page
           {% include page__taxonomy.html %}
           To change the look of the tags or categories and date I removed the above line and added the next lines and relevant CSS in minimal-mistakes.css
          {% endcomment %}

           <div class="meta-bar">
              <div class="meta-left">
                {% include page__taxonomy.html %}
              </div>
              <div class="meta-right">
                {% include page__date.html %}
              </div>
            </div>

            {% comment %} end of mine {% endcomment %}

        </header>
      {% endunless %}

      <section class="page__content e-content" itemprop="text">
        {% if page.toc %}
          <aside class="sidebar__right {% if page.toc_sticky %}sticky{% endif %}">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-{{ page.toc_icon | default: 'file-alt' }}"></i> {{ page.toc_label | default: site.data.ui-text[page.lang].toc_label | default: "On this page" }}</h4></header>
              {% include toc.html sanitize=true html=content h_min=1 h_max=6 class="toc__menu" skip_no_ids=true %}
            </nav>
          </aside>
        {% endif %}
        {{ content }}
        {% if page.link %}<div><a href="{{ page.link }}" class="btn btn--primary">{{ site.data.ui-text[page.lang].ext_link_label | default: "Direct Link" }}</a></div>{% endif %}
      </section>

      <footer class="page__meta">
        {% if site.data.ui-text[page.lang].meta_label %}
          <h4 class="page__meta-title">{{ site.data.ui-text[page.lang].meta_label }}</h4>
        {% endif %}

        {% comment %} {% include page__taxonomy.html %} 
         {% include page__date.html %} {% endcomment %}

      </footer>

      {% if page.share %}{% include social-share.html %}{% endif %}

      {% include post_pagination.html %}
    </div>

    {% comment %} I changed the comments by adding my own {% endcomment %}
    {% comment %} 
    {% if jekyll.environment == 'production' and site.comments.provider and page.comments %}
      {% include comments.html %}
    {% endif %}
    {% endcomment %}

    {% if page.comments %}
      <div id="comments-wrapper">
        <h3>{{ site.data.ui-text[page.lang].comments_title | default: "Kommentare" }}</h3>
      </div>

      <form id="comment-form">
        <input type="hidden" id="slug" value="{{ page.slug }}">
        <input type="hidden" id="parent-index" value="">
        <div id="replying-to" style="display:none;">
          {{ site.data.ui-text[page.lang].replying_to_label | default: "Replying to" }} <span id="replying-to-name"></span>
          <button type="button" id="cancel-reply">{{ site.data.ui-text[page.lang].comment_btn_cancel | default: "Cancel" }}</button>
        </div>

        <label>{{ site.data.ui-text[page.lang].comment_form_name_label }}<br><input id="name" required></label><br><br>
        <label>{{ site.data.ui-text[page.lang].comment_form_comment_label }}<br><textarea id="message" required></textarea></label><br><br>
        <label>{{ site.data.ui-text[page.lang].comment_form_email_label }} (optional)<br><input id="email"></label><br><br>
        <button type="submit">{{ site.data.ui-text[page.lang].comment_btn_submit }}</button>
        <div id="comment-status"></div>
      </form>

      <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
      <script>
      const commentForm = document.getElementById("comment-form");
      const parentInput = document.getElementById("parent-index");
      const messageField = document.getElementById("message");
      const replyIndicator = document.getElementById("replying-to");
      const replyingToName = document.getElementById("replying-to-name");
      const cancelReplyBtn = document.getElementById("cancel-reply");

      function setupReplyButton(btn, comment) {
        btn.addEventListener("click", () => {
          parentInput.value = comment.index;
          replyingToName.innerText = comment.name;
          replyIndicator.style.display = "flex";
          commentForm.scrollIntoView({ behavior: "smooth", block: "start" });
          setTimeout(() => messageField.focus(), 300);
        });
      }

      function appendComment(comment) {
        const div = document.createElement("div");
        div.className = "comment h-cite new-comment";
        div.dataset.index = comment.index;
        const htmlMessage = marked.parse(comment.message);
        div.innerHTML = `
          <p><strong>${comment.name}</strong> <small>${comment.date}</small></p>
          <div class="comment-text">${htmlMessage}</div>
          <button class="reply-btn" data-index="${comment.index}">{{ site.data.ui-text[page.lang].reply_label | default: "Reply" }}</button>
          <div class="replies"></div>
        `;
        if (comment.parentIndex) {
          const parent = document.querySelector(`.comment[data-index="${comment.parentIndex}"] .replies`);
          if (parent) parent.appendChild(div);
        } else {
          document.getElementById("comments-wrapper").appendChild(div);
        }
        setupReplyButton(div.querySelector(".reply-btn"), comment);
        setTimeout(() => div.classList.add("fade-out"), 50);
        setTimeout(() => div.classList.remove("new-comment", "fade-out"), 2050);
      }

      cancelReplyBtn.addEventListener("click", () => {
        parentInput.value = "";
        replyIndicator.style.display = "none";
      });

      commentForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const slug = document.getElementById("slug").value;
        const name = document.getElementById("name").value;
        const message = messageField.value;
        const email = document.getElementById("email")?.value || "";
        const parentIndex = parentInput.value;

        const res = await fetch("https://comment-worker.shant-ga.workers.dev", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ slug, name, message, email, parentIndex })
        });

        const statusEl = document.getElementById("comment-status");

        if (res.ok) {
          const savedComment = await res.json();
          appendComment(savedComment);
          statusEl.innerText = "{{ site.data.ui-text[page.lang].comment_success_msg }}";
          commentForm.reset();
          parentInput.value = "";
          replyIndicator.style.display = "none";
        } else {
          statusEl.innerHTML = "{{ site.data.ui-text[page.lang].comment_error_msg }}";
        }
      });
      </script>



        
    {% endif %}
  </article>

  {% comment %} only show related on a post page when `related: true` {% endcomment %}
  {% if page.id and page.related and site.related_posts.size > 0 %}
    <div class="page__related">
      <h2 class="page__related-title">{{ site.data.ui-text[page.lang].related_label | default: "You May Also Enjoy" }}</h2>
      <div class="grid__wrapper">
        {% for post in site.related_posts limit:4 %}
          {% include archive-single.html type="grid" %}
        {% endfor %}
      </div>
    </div>
  {% comment %}<!-- otherwise show recent posts if no related when `related: true` -->{% endcomment %}
  {% elsif page.id and page.related %}
    <div class="page__related">
      <h2 class="page__related-title">{{ site.data.ui-text[page.lang].related_label | default: "You May Also Enjoy" }}</h2>
      <div class="grid__wrapper">
        {% for post in site.posts limit:4 %}
          {% if post.id == page.id %}
            {% continue %}
          {% endif %}
          {% include archive-single.html type="grid" %}
        {% endfor %}
      </div>
    </div>
  {% endif %}
</div>


